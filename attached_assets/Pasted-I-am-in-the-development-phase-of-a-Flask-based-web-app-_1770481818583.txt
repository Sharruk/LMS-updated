I am in the development phase of a Flask-based web app and I want to prepare it for real deployment without breaking any existing functionality.

PLEASE READ CAREFULLY AND FOLLOW EXACTLY.

üß† CONTEXT:
This is a Tamil Nadu State Board Question Papers & Answer Keys Portal.
It is already working as an MVP.
DO NOT remove or rewrite existing routes, templates, or features.
Only MODIFY what is necessary to make it deploy-ready.

STACK:
- Python 3.11
- Flask
- Gunicorn
- SQLAlchemy
- PostgreSQL (preferred for production)
- Jinja templates
- uploads/ directory (temporary for MVP)

IMPORTANT REALITY CHECK:
- uploads/ folder is TEMPORARY and acceptable for MVP
- DO NOT migrate file storage to cloud yet
- Deployment must NOT break uploads or downloads

üéØ GOALS:
1. Confirm that this app CAN be deployed to Fly.io
2. Add or fix requirements.txt
3. Ensure Gunicorn works correctly
4. Ensure database works with PostgreSQL
5. Keep SQLite as fallback for local development
6. DO NOT remove admin panel, upload UI, comments, likes, downloads, or preview logic

üõ† TASKS TO PERFORM:

1Ô∏è‚É£ PROJECT AUDIT
- Check project structure
- Verify app.py, main.py, models.py usage
- Identify deployment blockers

2Ô∏è‚É£ REQUIREMENTS FILE
- Generate or fix requirements.txt
- Ensure it includes:
  Flask
  Gunicorn
  SQLAlchemy
  psycopg2-binary
  python-dotenv (if needed)

3Ô∏è‚É£ DATABASE CONFIGURATION
- Modify database config so:
  - PostgreSQL is used when DATABASE_URL exists
  - SQLite is used when DATABASE_URL is missing
- Use environment variable based configuration
- DO NOT hardcode credentials

4Ô∏è‚É£ GUNICORN COMPATIBILITY
- Ensure main.py exposes `app`
- Ensure app runs on PORT from environment with default 5000
- DO NOT use Flask dev server in production

5Ô∏è‚É£ DOCKER READINESS (DO NOT DEPLOY YET)
- Create Dockerfile suitable for Fly.io
- Use python:3.11-slim
- Expose port 5000
- Use Gunicorn with main:app
- Ensure uploads/ directory exists

6Ô∏è‚É£ SAFETY RULES (VERY IMPORTANT)
- DO NOT delete or rename templates
- DO NOT remove drag-and-drop upload
- DO NOT remove filename modification
- DO NOT remove preview logic
- DO NOT remove comments, likes, dislikes
- DO NOT redesign UI
- ONLY fix broken or missing deployment-related pieces

7Ô∏è‚É£ FINAL OUTPUT REQUIRED
- Explain clearly:
  ‚úî Is this app deployable to Fly.io? (YES/NO)
  ‚úî What was fixed or added
  ‚úî What still needs to be done later (file storage migration)
- Show exact files changed
- Show final requirements.txt
- Show Dockerfile
- Show updated database config code

DO NOT:
- Convert framework
- Rewrite frontend
- Suggest React/FastAPI
- Suggest paid services

This is a DEPLOYMENT PREPARATION TASK, not a refactor.
